<section data-ng-controller="PeopleController" data-ng-init="find()">
    <br>
    <div class="row">
        <div class="col-sm-12">
            <div class="panel-heading">
                <ol class="breadcrumb">
                    <li>Setup</li>
                    <li>Stakeholders</li>
                    <li class="active">People</li>
                </ol>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
            <br>
            <button class="btn btn-primary"
                    ng-click="create()">
                New person
            </button>
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="alert alert-warning text-center" data-ng-hide="people.length">
            No people yet, why don't you create one?
        </div>
        <div class="col-md-4" data-ng-repeat="person in people" data-ng-switch="switchPersonForm[person._id]" >
            <div class="panel panel-default" title="Last updated on {{person.created | date:'medium'}} by {{person.user.displayName}}">
                <div class="panel-body">
                    <div ng-switch-default="view">
                        <form class="form">
                            <fieldset>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label class="control-label" for="name">Name</label>
                                            <div class="controls">
                                                <input id="name" disabled type="text" class="form-control" ng-model="person.name">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label" for="title">Title</label>
                                            <div class="controls">
                                                <input id="title" disabled type="text" class="form-control" ng-model="person.title">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label" for="email">Email</label>
                                            <div class="controls">
                                                <input id="email" disabled type="email" class="form-control" ng-model="person.email">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label" for="phone">Phone</label>
                                            <div class="controls">
                                                <input id="phone" disabled type="text" class="form-control" ng-model="person.phone">
                                            </div>
                                        </div>
                                        <div class="form-group center-block">
                                            <button type="button" class="btn btn-success" ng-click="selectPerson(person)">
                                                Edit
                                            </button>
                                        </div>
                                        <div class="form-group">
                                            <div data-ng-show="error" class="text-danger">
                                                <strong data-ng-bind="error"></strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                    <div data-ng-switch-when="edit">
                        <form class="form" name="editPersonForm" data-ng-submit="update(person)" novalidate>
                            <fieldset>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label class="control-label" for="nameEdit">Name</label>
                                            <div class="controls">
                                                <input id="nameEdit" type="text" class="form-control" ng-model="person.name">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label" for="titleEdit">Title</label>
                                            <div class="controls">
                                                <input id="titleEdit" type="text" class="form-control" ng-model="person.title">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label" for="emailEdit">Email</label>
                                            <div class="controls">
                                                <input id="emailEdit" name="emailEdit" type="email" class="form-control" ng-model="person.email">
                                            </div>
                                            <span class="error" ng-show="editPersonForm.emailEdit.$error.email">Not a valid email address</span>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label" for="phoneEdit">Phone</label>
                                            <div class="controls">
                                                <input id="phoneEdit" type="text" class="form-control" ng-model="person.phone">
                                            </div>
                                        </div>
                                        <div class="form-group center-block">
                                            <input type="submit" value="Save" class="btn btn-success" ng-disabled="editPersonForm.$error.email">
                                            <a class="btn btn-danger" data-ng-click="remove(person)">
                                                <i class="glyphicon glyphicon-trash"></i>
                                            </a>
                                            <button type="button" class="btn btn-info" ng-click="cancelEdit(person)">
                                                Cancel
                                            </button>
                                        </div>
                                        <div class="form-group">
                                            <div data-ng-show="error" class="text-danger">
                                                <strong data-ng-bind="error"></strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
