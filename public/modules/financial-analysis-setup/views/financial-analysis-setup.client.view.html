<section data-ng-controller="FinancialAnalysisSetupController" data-ng-init="init()">
	<br>
	<div class="row">
		<div class="col-sm-12">
			<div class="panel-heading">
				<ol class="breadcrumb">
					<li>Setup</li>
					<li>Portfolio evaluation</li>
					<li class="active">Financial analysis</li>
				</ol>
			</div>
		</div>
	</div>
	<div data-ng-show="initError" class="text-danger">
		<strong data-ng-bind="initError"></strong>
	</div>
	<div class="row">
		<div class="col-md-12">
			<tabset>
                <tab heading="Costs">
                    <br>
                    <div class="row" data-ng-show="userHasAuthorization">
                        <div class="col-md-3">
                            <br>
                            <button class="btn btn-primary" ng-click="createCostGroup()">
                                New cost group
                            </button>
                            <div data-ng-show="error" class="text-danger">
                                <strong data-ng-bind="error"></strong>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-md-12 form-group" data-ng-repeat="group in costGroups track by $index">
                            <button class="btn btn-default btn-lg btn-block" data-ng-bind="group.name" data-ng-click="viewCostGroupDetails = !viewCostGroupDetails"
                                    title="Last updated on {{group.created | date:'medium'}} by {{group.user.displayName}}"></button>
                            <div data-ng-show="viewCostGroupDetails">
                                <div class="panel panel-default" >
                                    <div class="panel-body">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="panel panel-default" data-ng-switch="switchCostGroupForm[group._id]">
                                                    <div class="panel-body" ng-switch-default="view">
                                                        <div class="row">
                                                            <div class="col-md-7 form-group">
                                                                <label for="groupName" class="control-label">Cost Group name</label>
                                                                <input disabled id="groupName" type="text" class="form-control" data-ng-model="group.name">
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-12 form-group">
                                                                <label for="groupDescription" class="control-label">Cost Group description</label>
                                                                <textarea disabled id="groupDescription" data-ng-model="group.description" class="form-control" placeholder="No description yet"></textarea>
                                                            </div>
                                                        </div>
                                                        <div class="row" data-ng-show="userHasAuthorization">
                                                            <div class="col-md-12">
                                                                <div class="form-group pull-right">
                                                                    <button class="btn btn-success" data-ng-click="selectCostGroup(group)">Edit</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="panel-body" ng-switch-when="edit">
                                                        <form name="editCostGroupForm" novalidate>
                                                            <fieldset>
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="panel-body">
                                                                            <div class="row">
                                                                                <div class="col-md-7 form-group">
                                                                                    <label for="groupNameEdit" class="control-label">Cost Group name</label>
                                                                                    <input id="groupNameEdit" name="groupNameEdit" type="text" class="form-control" data-ng-model="group.name" required>
                                                                                    <span data-ng-show="editCostGroupForm.groupNameEdit.$error.required">
                                                                                        <em style="color: red">Name is required</em>
                                                                                    </span>
                                                                                </div>
                                                                            </div>
                                                                            <div class="row">
                                                                                <div class="col-md-12 form-group">
                                                                                    <label for="groupDescription" class="control-label">Cost Group description</label>
                                                                                    <textarea id="groupDescription" data-ng-model="group.description" class="form-control" placeholder="No description yet"></textarea>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="form-group pull-right">
                                                                            <button type="button" class="btn btn-success" data-ng-click="updateCostGroup(group)" data-ng-disabled="editCostGroupForm.$invalid">
                                                                                Save
                                                                            </button>
                                                                            <button type="button" class="btn btn-danger" data-ng-click="removeCostGroup(group)">
                                                                                Delete cost group
                                                                            </button>
                                                                            <button type="button" class="btn btn-info" data-ng-click="cancelEditCostGroup(group)">
                                                                                Cancel
                                                                            </button>
                                                                            <div data-ng-show="error" class="text-danger">
                                                                                <strong data-ng-bind="error"></strong>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </fieldset>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="panel panel-default">
                                                    <div class="panel-body">
                                                        <div class="row" data-ng-show="userHasAuthorization">
                                                            <div class="col-md-3">
                                                                <div class="form-group">
                                                                    <button type="button" class="btn btn-primary" ng-click="createCostType(group)">
                                                                        New cost type
                                                                    </button>
                                                                </div>
                                                                <div data-ng-show="error" class="text-danger">
                                                                    <strong data-ng-bind="error"></strong>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-4 form-group" data-ng-repeat="type in group.costTypes track by $index" data-ng-switch="switchCostTypeForm[type._id]">
                                                                <button class="btn btn-default btn-lg btn-block" data-ng-bind="type.name" data-ng-click="viewCostTypeDetails = !viewCostTypeDetails"
                                                                        title="Last updated on {{type.created | date:'medium'}} by {{type.user.displayName}}"></button>
                                                                <div data-ng-show="viewCostDetails">
                                                                    <div class="panel panel-default">
                                                                        <div class="panel-body" ng-switch-default="view">
                                                                            <div class="row">
                                                                                <div class="col-md-12">
                                                                                    <form>
                                                                                        <fieldset>
                                                                                            <div class="row">
                                                                                                <div class="form-group col-md-12">
                                                                                                    <label for="costName" class="control-label">Cost type name</label>
                                                                                                    <input disabled id="costName" type="text" class="form-control" data-ng-model="type.name">
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="row">
                                                                                                <div class="form-group col-md-12">
                                                                                                    <label for="costDescription" class="control-label">Cost type description</label>
                                                                                                    <textarea disabled id="costDescription" data-ng-model="type.description" class="form-control" placeholder="No description yet"></textarea>
                                                                                                </div>
                                                                                            </div>
                                                                                        </fieldset>
                                                                                    </form>
                                                                                    <div class="row" data-ng-show="userHasAuthorization">
                                                                                        <div class="form-group col-md-12 pull-right">
                                                                                            <button type="button" class="btn btn-success pull-right"
                                                                                                    data-ng-click="selectEditCostType(group, type)">
                                                                                                Edit
                                                                                            </button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="panel-body" ng-switch-when="edit">
                                                                            <div class="row" >
                                                                                <div class="col-md-12">
                                                                                    <form name="editCostForm" novalidate>
                                                                                        <fieldset>
                                                                                            <div class="row">
                                                                                                <div class="form-group col-md-12">
                                                                                                    <label for="costNameEdit" class="control-label">Cost type name</label>
                                                                                                    <input id="costNameEdit" name="costNameEdit" type="text" class="form-control" data-ng-model="type.name" required>
                                                                                                    <span data-ng-show="editCostForm.costNameEdit.$error.required">
                                                                                                        <em style="color: red">Name is required</em>
                                                                                                    </span>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="row">
                                                                                                <div class="form-group col-md-12">
                                                                                                    <label for="costDescriptionEdit" class="control-label">Cost type description</label>
                                                                                                    <textarea id="costDescriptionEdit" data-ng-model="type.description" class="form-control" placeholder="No description yet"></textarea>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="row">
                                                                                                <div class="col-md-12">
                                                                                                    <div class="form-group pull-right">
                                                                                                        <button type="button" class="btn btn-success" ng-click="updateCostType(group, type)" data-ng-disabled="editCostForm.$invalid">
                                                                                                            Save
                                                                                                        </button>
                                                                                                        <a class="btn btn-danger" data-ng-click="removeCostType(group, cost)">
                                                                                                            <i class="glyphicon glyphicon-trash"></i>
                                                                                                        </a>
                                                                                                        <button type="button" class="btn btn-info" ng-click="cancelEditCostType(cost)">
                                                                                                            Cancel
                                                                                                        </button>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div data-ng-show="error" class="text-danger">
                                                                                                <strong data-ng-bind="error"></strong>
                                                                                            </div>
                                                                                        </fieldset>
                                                                                    </form>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="alert alert-warning text-center" data-ng-show="group.costTypes.length === 0">
                                                            No cost types added to this group yet
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="alert alert-warning text-center" data-ng-hide="!costGroups.$resolved || costGroups.length">
                        No cost groups yet
                    </div>
                </tab>
				<tab heading="Benefits">
					<br>
					<div class="row" data-ng-show="userHasAuthorization">
						<div class="col-md-3">
							<br>
							<button class="btn btn-primary" ng-click="createBenefitGroup()">
								New benefit group
							</button>
							<div data-ng-show="error" class="text-danger">
								<strong data-ng-bind="error"></strong>
							</div>
						</div>
					</div>
					<hr>
					<div class="row">
						<div class="col-md-12 form-group" data-ng-repeat="group in benefitGroups track by $index">
							<button class="btn btn-default btn-lg btn-block" data-ng-bind="group.name" data-ng-click="viewBenefitGroupDetails = !viewBenefitGroupDetails"
									title="Last updated on {{group.created | date:'medium'}} by {{group.user.displayName}}"></button>
							<div data-ng-show="viewBenefitGroupDetails">
								<div class="panel panel-default" >
									<div class="panel-body">
										<div class="row">
											<div class="col-md-12">
												<div class="panel panel-default" data-ng-switch="switchBenefitGroupForm[group._id]">
													<div class="panel-body" ng-switch-default="view">
														<div class="row">
															<div class="col-md-7 form-group">
																<label for="groupName" class="control-label">Benefit Group name</label>
																<input disabled id="groupName" type="text" class="form-control" data-ng-model="group.name">
															</div>
														</div>
														<div class="row">
															<div class="col-md-12 form-group">
																<label for="groupDescription" class="control-label">Benefit Group description</label>
																<textarea disabled id="groupDescription" data-ng-model="group.description" class="form-control" placeholder="No description yet"></textarea>
															</div>
														</div>
														<div class="row" data-ng-show="userHasAuthorization">
															<div class="col-md-12">
																<div class="form-group pull-right">
																	<button class="btn btn-success" data-ng-click="selectBenefitGroup(group)">Edit</button>
																</div>
															</div>
														</div>
													</div>
													<div class="panel-body" ng-switch-when="edit">
														<form name="editBenefitGroupForm" novalidate>
															<fieldset>
																<div class="row">
																	<div class="col-md-12">
																		<div class="panel-body">
																			<div class="row">
																				<div class="col-md-7 form-group">
																					<label for="benefitGroupNameEdit" class="control-label">Benefit Group name</label>
																					<input id="benefitGroupNameEdit" name="benefitGroupNameEdit" type="text" class="form-control" data-ng-model="group.name" required>
                                                                                    <span data-ng-show="editBenefitGroupForm.benefitGroupNameEdit.$error.required">
                                                                                        <em style="color: red">Name is required</em>
                                                                                    </span>
																				</div>
																			</div>
																			<div class="row">
																				<div class="col-md-12 form-group">
																					<label for="groupDescription" class="control-label">Benefit Group description</label>
																					<textarea id="groupDescription" data-ng-model="group.description" class="form-control" placeholder="No description yet"></textarea>
																				</div>
																			</div>
																		</div>
																	</div>
																</div>
																<div class="row">
																	<div class="col-md-12">
																		<div class="form-group pull-right">
																			<button type="button" class="btn btn-success" data-ng-click="updateBenefitGroup(group)" data-ng-disabled="editBenefitGroupForm.$invalid">
																				Save
																			</button>
																			<button type="button" class="btn btn-danger" data-ng-click="removeBenefitGroup(group)">
																				Delete benefit group
																			</button>
																			<button type="button" class="btn btn-info" data-ng-click="cancelEditBenefitGroup(group)">
																				Cancel
																			</button>
																			<div data-ng-show="error" class="text-danger">
																				<strong data-ng-bind="error"></strong>
																			</div>
																		</div>
																	</div>
																</div>
															</fieldset>
														</form>
													</div>
												</div>
											</div>
										</div>
										<div class="row">
											<div class="col-md-12">
												<div class="panel panel-default">
													<div class="panel-body">
														<div class="row" data-ng-show="userHasAuthorization">
															<div class="col-md-3">
																<div class="form-group">
																	<button type="button" class="btn btn-primary" ng-click="createBenefitType(group)">
																		New benefit type
																	</button>
																</div>
																<div data-ng-show="error" class="text-danger">
																	<strong data-ng-bind="error"></strong>
																</div>
															</div>
														</div>
														<div class="row">
															<div class="col-md-4 form-group" data-ng-repeat="type in group.benefitTypes track by $index" data-ng-switch="switchBenefitTypeForm[type._id]">
																<button class="btn btn-default btn-lg btn-block" data-ng-bind="type.name" data-ng-click="viewBenefitTypeDetails = !viewBenefitTypeDetails"
																		title="Last updated on {{type.created | date:'medium'}} by {{type.user.displayName}}"></button>
																<div data-ng-show="viewBenefitDetails">
																	<div class="panel panel-default">
																		<div class="panel-body" ng-switch-default="view">
																			<div class="row">
																				<div class="col-md-12">
																					<form>
																						<fieldset>
																							<div class="row">
																								<div class="form-group col-md-12">
																									<label for="benefitName" class="control-label">Benefit type name</label>
																									<input disabled id="benefitName" type="text" class="form-control" data-ng-model="type.name">
																								</div>
																							</div>
																							<div class="row">
																								<div class="form-group col-md-12">
																									<label for="benefitDescription" class="control-label">Benefit type description</label>
																									<textarea disabled id="benefitDescription" data-ng-model="type.description" class="form-control" placeholder="No description yet"></textarea>
																								</div>
																							</div>
																						</fieldset>
																					</form>
																					<div class="row" data-ng-show="userHasAuthorization">
																						<div class="form-group col-md-12 pull-right">
																							<button type="button" class="btn btn-success pull-right"
																									data-ng-click="selectEditBenefitType(group, type)">
																								Edit
																							</button>
																						</div>
																					</div>
																				</div>
																			</div>
																		</div>
																		<div class="panel-body" ng-switch-when="edit">
																			<div class="row" >
																				<div class="col-md-12">
																					<form name="editBenefitForm" novalidate>
																						<fieldset>
																							<div class="row">
																								<div class="form-group col-md-12">
																									<label for="benefitNameEdit" class="control-label">Benefit type name</label>
																									<input id="benefitNameEdit" name="benefitNameEdit" type="text" class="form-control" data-ng-model="type.name" required>
                                                                                                    <span data-ng-show="editBenefitForm.benefitNameEdit.$error.required">
                                                                                                        <em style="color: red">Name is required</em>
                                                                                                    </span>
																								</div>
																							</div>
																							<div class="row">
																								<div class="form-group col-md-12">
																									<label for="benefitDescriptionEdit" class="control-label">Benefit type description</label>
																									<textarea id="benefitDescriptionEdit" data-ng-model="type.description" class="form-control" placeholder="No description yet"></textarea>
																								</div>
																							</div>
																							<div class="row">
																								<div class="col-md-12">
																									<div class="form-group pull-right">
																										<button type="button" class="btn btn-success" ng-click="updateBenefitType(group, type)" data-ng-disabled="editBenefitForm.$invalid">
																											Save
																										</button>
																										<a class="btn btn-danger" data-ng-click="removeBenefitType(group, type)">
																											<i class="glyphicon glyphicon-trash"></i>
																										</a>
																										<button type="button" class="btn btn-info" ng-click="cancelEditBenefitType(type)">
																											Cancel
																										</button>
																									</div>
																								</div>
																							</div>
																							<div data-ng-show="error" class="text-danger">
																								<strong data-ng-bind="error"></strong>
																							</div>
																						</fieldset>
																					</form>
																				</div>
																			</div>
																		</div>
																	</div>
																</div>
															</div>
														</div>
														<div class="alert alert-warning text-center" data-ng-show="group.benefitTypes.length === 0">
															No benefit types added to this group yet
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="alert alert-warning text-center" data-ng-hide="!benefitGroups.$resolved || benefitGroups.length">
						No benefit groups yet
					</div>
				</tab>
			</tabset>
		</div>
	</div>
</section>
