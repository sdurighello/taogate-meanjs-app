<section data-ng-controller="DashboardFinancialController" data-ng-init="init()">
	<br>
	<div class="row">
		<div class="col-sm-12">
			<div class="panel-heading">
				<ol class="breadcrumb">
					<li>Dashboards</li>
					<li>Portfolio evaluation</li>
					<li class="active">Financial profiles</li>
				</ol>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-sm-3"><!-- PROJECTS LIST -->
			<div class="panel panel-default">
				<div class="panel-heading">
					<h6 class="panel-title text-center">Projects</h6>
				</div>
				<div class="panel-body">
					<div class="row">
						<div class=" form-group col-md-12">
							<select id="" class="form-control input-sm" data-ng-model="filterProfileProcess"
									ng-options="process.name for process in gateProcesses">
								<option value="">--filter by gate process</option>
							</select>
						</div>
						<div class=" form-group col-md-12">
							<select id="" class="form-control input-sm" data-ng-model="filterProfilePortfolio"
									ng-options="portfolio.name for portfolio in portfolios">
								<option value="">--filter by portfolio</option>
							</select>
						</div>
						<div class="col-md-12 form-group-sm">
							<input id="" type="text" class="form-control input-sm"
								   data-ng-model="filterProfileProject.name" placeholder="Filter by project name">
						</div>
					</div>
					<hr>
					<div class="row" style="min-height: 350px; max-height: 350px; overflow-y: auto">
						<div class="col-md-12">
							<div data-ng-show="projects.length === 0" class="alert alert-warning text-center">
								There are no projects in evaluation
							</div>
							<button type="button"
									data-ng-repeat="project in projects | filter:{identification: filterProfileProject, portfolio: filterProfilePortfolio._id, process: filterProfileProcess._id} "
									data-ng-click="selectProject(project)"
									class="btn btn-default btn-sm center-block btn-block" style="overflow: hidden;">
								{{project.identification.idNumber}} - {{project.identification.name}}
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-md-9">
			<div class="row">
				<div class="col-md-12">
					<div data-ng-hide="selectedProject || Projects.length === 0" class="alert alert-warning text-center">
						Select a project to see its details
					</div>
				</div>
			</div>
			<div data-ng-show="selectedProject">
				<div class="row">
					<div class="col-md-12">
						<div class="row">
							<div class="col-sm-6">
								<div class="panel panel-default">
									<div><h5>&nbsp;Project: <i>{{selectedProject.identification.name}}</i></h5></div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="panel panel-default">
									<div><h5>&nbsp;Process: <i>{{selectedProject.process.name}}</i></h5></div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="panel panel-default">
							<div class="panel-heading">
								<h6 class="panel-title text-center">Financial indicators</h6>
							</div>
							<div class="panel-body">
								<div class="row">
									<div class="form-group col-md-3">
										<label for="">NPV</label>
										<p>{{financialProfile.financialRatios.totalNetDiscounted | number : 0}}</p>
									</div>
									<div class="form-group col-md-3">
										<label for="">IRR</label>
										<p>{{100 * financialProfile.financialRatios.IRR | number : 0}}%</p>
									</div>
									<div class="form-group col-md-3">
										<label for="">Payback years</label>
										<p>{{financialProfile.financialRatios.paybackPeriod | number : 1}}</p>
									</div>
									<div class="form-group col-md-3">
										<label for="">Benefit/Cost Ratio</label>
										<p>{{financialProfile.financialRatios.benefitCostRatio | number : 1}}</p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-xs-12">
						<div class="panel panel-default">
							<div class="panel-heading">
								<h6 class="panel-title text-center">Yearly overview</h6>
							</div>
							<div class="panel-body">
								<div class="table-responsive">
									<table class="table table-bordered table-hover table-condensed small">
										<thead>
										<tr>
											<th class="text-center">Year</th>
											<th class="text-center" colspan="3">Original</th>
											<th class="text-center" colspan="3">Discounted</th>
										</tr>
										<tr>
											<td> </td>
											<th class="text-center">Benefits</th>
											<th class="text-center">Costs</th>
											<th class="text-center">Net</th>
											<th class="text-center">Benefits</th>
											<th class="text-center">Costs</th>
											<th class="text-center">Net</th>
										</tr>
										</thead>
										<tbody>
										<tr data-ng-repeat="yearlyItem in financialProfile.yearlyData">
											<td class="text-center">{{yearlyItem.year}}</td>
											<td class="text-center">{{yearlyItem.yearlyBenefit | number : 0}}</td>
											<td class="text-center">{{yearlyItem.yearlyCost | number : 0}}</td>
											<td class="text-center">{{yearlyItem.yearlyNet | number : 0}}</td>
											<td class="text-center">{{yearlyItem.yearlyBenefitDiscounted | number : 0}}</td>
											<td class="text-center">{{yearlyItem.yearlyCostDiscounted | number : 0}}</td>
											<td class="text-center">{{yearlyItem.yearlyNetDiscounted | number : 0}}</td>
										</tr>
										<tr>
											<td> </td>
											<td class="text-center"><b>{{financialProfile.financialRatios.totalBenefit | number : 0}}</b></td>
											<td class="text-center"><b>{{financialProfile.financialRatios.totalCost | number : 0}}</b></td>
											<td class="text-center"><b>{{financialProfile.financialRatios.totalNet | number : 0}}</b></td>
											<td class="text-center"><b>{{financialProfile.financialRatios.totalBenefitDiscounted | number : 0}}</b></td>
											<td class="text-center"><b>{{financialProfile.financialRatios.totalCostDiscounted | number : 0}}</b></td>
											<td class="text-center"><b>{{financialProfile.financialRatios.totalNetDiscounted | number : 0}}</b></td>
										</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
